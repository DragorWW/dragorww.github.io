import"./MatrixBackground.astro_astro_type_script_index_0_lang.OhnpFp5b.js";import{h as m}from"./vendor.B4CzG4On.js";const r=document.getElementById("sourceContainer"),d=document.getElementById("previewImage"),v=document.getElementById("downloadBtn"),c=document.getElementById("previewLoader");let o=null;const p=(e,n)=>{let t;return(...u)=>{t&&clearTimeout(t),t=setTimeout(()=>{e(...u)},n)}},i=async()=>{if(!(!r||!d))try{c?.classList.add("loading"),o=(await m(r.querySelector(".cover-preview"),{width:1200,height:630,scale:2,useCORS:!0,allowTaint:!0,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--bg-color").trim()})).toDataURL("image/png",1),d.src=o}catch(e){console.error("Ошибка при создании превью:",e)}finally{c?.classList.remove("loading")}},g=p(i,500);document.addEventListener("preview-update",e=>{const n=document.getElementById("coverTitle"),t=document.getElementById("coverDescription");n&&(n.textContent=e.detail.title||"Заголовок обложки"),t&&(t.textContent=e.detail.description||"Описание обложки"),g()});window.addEventListener("load",i);v?.addEventListener("click",()=>{if(!o)return;const e=document.createElement("a");e.download="cover.png",e.href=o,e.click()});const E=document.getElementById("coverForm"),a=document.getElementById("title"),l=document.getElementById("description"),s=()=>{const e=new CustomEvent("preview-update",{detail:{title:a.value||"Заголовок обложки",description:l.value||"Описание обложки"}});document.dispatchEvent(e)};a?.addEventListener("input",s);l?.addEventListener("input",s);E?.addEventListener("submit",e=>{e.preventDefault()});
